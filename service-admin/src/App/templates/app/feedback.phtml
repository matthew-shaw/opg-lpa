<?php $this->layout('layout::default', ['title' => 'Feedback']);

$this->addErrorMap([
    'start-date' => [
        'empty-string' => [
            'summary'   => 'You didn\'t enter a start date',
            'field'     => 'Enter the start date'
        ],
        'invalid-date' => [
            'summary'   => 'You didn\'t enter a valid start date',
            'field'     => 'Enter a valid start date in the past'
        ],
        'future-date' => [
            'summary'   => 'The start date is in the future',
            'field'     => 'Enter a valid start date in the past'
        ],
    ],
    'end-date' => [
        'empty-string' => [
            'summary'   => 'You didn\'t enter an end date',
            'field'     => 'Enter the end date'
        ],
        'invalid-date' => [
            'summary'   => 'You didn\'t enter a valid end date',
            'field'     => 'Enter a valid end date in the past'
        ],
        'future-date' => [
            'summary'   => 'The end date is in the future',
            'field'     => 'Enter a valid end date in the past'
        ],
    ]
]);
?>

<div class="grid-row">
    <div class="column-full">

        <form method="post" class="form" action="<?= $this->url('feedback') ?>">

            <fieldset>

                <legend>
                    <h1 class="heading-xlarge">Feedback</h1>
                </legend>

                <?php $this->insert('snippet::error-summary', ['form' => $form]) ?>

                <?php $this->insert('snippet::input-hidden', ['formElement' => $form->get('secret')]) ?>

                <?php $this->insert('snippet::input-date', [
                    'formLabel'     => 'Start date',
                    'formElement'   => $form->get('start-date'),
                    'formLabelBold' => true,
                ]) ?>

                <?php $this->insert('snippet::input-date', [
                    'formLabel'     => 'End date',
                    'formElement'   => $form->get('end-date'),
                    'formLabelBold' => true,
                ]) ?>

            </fieldset>

            <div class="form-group">
                <input class="button" type="submit" value="Search">
            </div>

        </form>

        <?php /* if (!is_null($user)) { ?>

            <h2 class="heading-medium">User details</h2>

            <ul>
                <li>
                    <strong class="bold-small">Account status: </strong>

                    <?php if (array_key_exists('isActive', $user)) { ?>
                        <span><?= ($user['isActive'] ? 'Activated' : 'Not activated'); ?></span>
                    <?php } elseif (array_key_exists('isDeleted', $user) && $user['isDeleted']) { ?>
                        <span>Deleted</span>
                    <?php } ?>
                </li>

                <?php if (array_key_exists('lastLoginAt', $user)) { ?>
                    <li>
                        <strong class="bold-small">Last login time: </strong>
                        <span><?= ($user['lastLoginAt'] instanceof DateTime ? ($user['lastLoginAt'])->format('jS M Y \\a\\t g:i:s a') : 'Never logged in'); ?></span>
                    </li>
                <?php } ?>

                <?php if (array_key_exists('failedLoginAttempts', $user)) { ?>
                    <li>
                        <strong class="bold-small">Number of failed login attempts: </strong>
                        <span><?= $user['failedLoginAttempts']; ?></span>
                    </li>
                <?php } ?>

                <?php if (array_key_exists('isDeleted', $user) && $user['isDeleted']) { ?>
                    <li>
                        <strong class="bold-small">Deleted on: </strong>
                        <span><?= ($user['deletedAt'] instanceof DateTime ? ($user['deletedAt'])->format('jS M Y \\a\\t g:i:s a') : 'Unknown'); ?></span>
                    </li>
                    <li>
                        <strong class="bold-small">Due to: </strong>

                        <?php if ($user['reason'] == 'expired') { ?>
                            <span>Account expired</span>
                        <?php } elseif ($user['reason'] == 'unactivated') { ?>
                            <span>User did not activate account</span>
                        <?php } elseif ($user['reason'] == 'user-initiated') { ?>
                            <span>User manually deleted their account</span>
                        <?php } ?>
                    </li>
                <?php } ?>

                <?php if (array_key_exists('numberOfLpas', $user)) { ?>
                    <li>
                        <strong class="bold-small">Number of LPAs: </strong>
                        <span><?= $user['numberOfLpas']; ?></span>
                    </li>
                <?php } ?>
            </ul>

        <?php } */ ?>

    </div>
</div>
